[package]
name = "gadget-sdk"
version = "0.1.0"
authors.workspace = true
edition.workspace = true
homepage.workspace = true
repository.workspace = true


[dependencies]
thiserror = { workspace = true }
parking_lot = { workspace = true }
rand_core = { workspace = true, default-features = false }
rand = { workspace = true, optional = true }
hex = { workspace = true, default-features = false }
elliptic-curve = { workspace = true }

# Keystore deps
k256 = { workspace = true, features = ["ecdsa-core", "arithmetic"] }
ed25519-zebra = { workspace = true }
schnorrkel = { workspace = true }
w3f-bls = { workspace = true }

# Metrics deps
hyper = { workspace = true, default-features = false, features = ["http1", "server"] }
prometheus = { workspace = true, default-features = false }
tokio = { workspace = true, features = ["rt-multi-thread", "parking_lot"] }

# Logging deps
log = { workspace = true }
tracing = { workspace = true, default-features = false }
tracing-log = { workspace = true, default-features = false }
tracing-subscriber = { workspace = true, default-features = false }
tracing-wasm = { workspace = true, optional = true }

# Networking deps
gadget-io = { workspace = true }
gadget-core = { workspace = true }
bincode = { workspace = true }
gadget-common = { workspace = true }
serde = { workspace = true }
async-trait = { workspace = true }
futures = { workspace = true }
sp-io = { workspace = true }
sp-core = { workspace = true }

# WASM-only deps
getrandom = { workspace = true, optional = true }
wasm-bindgen-test = { workspace = true, optional = true }

# Macros
gadget-blueprint-proc-macro = { workspace = true }
tangle-subxt = { workspace = true, default-features = false }
# Event Watchers and Handlers
subxt = { workspace = true, default-features = false }
backoff = { workspace = true }

[target.'cfg(not(target_family = "wasm"))'.dev-dependencies]
hyper = { version = "0.14.16", default-features = false, features = ["client"] }

[target.'cfg(not(target_family = "wasm"))'.dependencies.libp2p]
workspace = true
features = [
  "tokio",
  "gossipsub",
  "mdns",
  "noise",
  "macros",
  "yamux",
  "tcp",
  "quic",
  "request-response",
  "cbor",
  "identify",
  "kad",
  "dcutr",
  "relay",
  "ping",
  "dns",
  "autonat"
]

[target.'cfg(target_family = "wasm")'.dependencies.libp2p]
workspace = true
default-features = false

[features]
default = [
  # "full",
  "std"
]
std = [
  "alloc",
  "rand",
  "getrandom",
  "hex/std",
]
alloc = ["rand_core/alloc", "hex/alloc"]
# full = [
#   "events-watcher",
#   "keystore",
#   "macros",
#   "tx-tangle",
#   "networking-libp2p",
# ]
# networking-libp2p = ["gadget-io", "bincode", "libp2p", "gadget-common", "serde", "async-trait", "futures", "gadget-core", "sp-io", "sp-core"]

wasm = [
  "getrandom/js",
  "tracing-wasm",
  "wasm-bindgen-test",
]

# Randomness
getrandom = ["rand_core/getrandom"]

# Keystore features
# keystore = [
#   "keystore-ecdsa",
#   "keystore-sr25519",
#   "keystore-ed25519",
#   "keystore-bls381",
#   "keystore-fs",
# ]
# keystore-ecdsa = ["k256", "elliptic-curve/sec1"]
# keystore-sr25519 = ["schnorrkel"]
# keystore-ed25519 = ["ed25519-zebra"]
# keystore-bls381 = ["w3f-bls"]
# Keystore backends
# Requires: std
# keystore-fs = []

# metrics = ["hyper", "prometheus", "tokio"]
# logging = ["tracing-subscriber"]

# macros = ["gadget-blueprint-proc-macro", "tangle-subxt"]

# events-watcher = ["subxt/jsonrpsee", "subxt/native", "backoff", "tokio/time"]
# tx-tangle = ["tangle-subxt", "backoff"]
