[package]
name = "gadget-contexts"
version = "0.1.0"
authors.workspace = true
edition.workspace = true
license.workspace = true
homepage.workspace = true
repository.workspace = true

[dependencies]
# Core dependencies (always required)
gadget-config = { workspace = true }
gadget-keystore = { workspace = true }
itertools = { workspace = true }
auto_impl = { workspace = true }
uuid = { workspace = true }
failure = { workspace = true }
lazy_static = { workspace = true }
thiserror = { workspace = true }
color-eyre = { workspace = true }
log = { workspace = true }
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true }
async-trait = { workspace = true }
futures = { workspace = true }

# Cryptography (core)
elliptic-curve = { workspace = true, features = ["alloc", "sec1"] }
hex = { workspace = true, features = ["alloc"] }
rand = { workspace = true, features = ["alloc"] }

# Optional dependencies based on features
tokio = { workspace = true, optional = true }
tokio-stream = { workspace = true, features = ["io-util", "sync"], optional = true }
tokio-util = { workspace = true, optional = true }
parking_lot = { workspace = true, optional = true }
sqlx = { workspace = true, features = ["runtime-tokio-rustls", "sqlite"], optional = true }
nix = { workspace = true, optional = true }
http-body-util = { workspace = true, optional = true }
hyper = { workspace = true, features = ["http1", "server"], optional = true }
hyper-util = { workspace = true, features = ["server"], optional = true }
symbiotic-rs = { workspace = true, optional = true }
backon = { workspace = true, optional = true }

# Keystore-related (moved to keystore feature)
ed25519-zebra = { workspace = true, optional = true }
k256 = { workspace = true, features = ["ecdsa", "ecdsa-core", "arithmetic"], optional = true }
schnorrkel = { workspace = true, optional = true }
w3f-bls = { workspace = true, optional = true }

# EVM-related
alloy-contract = { workspace = true, optional = true }
alloy-network = { workspace = true, optional = true }
alloy-primitives = { workspace = true, optional = true }
alloy-json-abi = { workspace = true, features = ["serde_json"], optional = true }
alloy-provider = { workspace = true, optional = true }
alloy-rpc-types = { workspace = true, optional = true }
alloy-sol-types = { workspace = true, optional = true }
alloy-transport = { workspace = true, optional = true }
alloy-transport-http = { workspace = true, optional = true }
alloy-signer = { workspace = true, optional = true }
alloy-signer-local = { workspace = true, optional = true }
eigensdk = { workspace = true, features = ["full", "utils", "types"], optional = true }

# Tangle-related
subxt = { workspace = true, optional = true, features = ["substrate-compat"] }
subxt-core = { workspace = true, features = ["substrate-compat"], optional = true }
subxt-signer = { workspace = true, features = ["sr25519"], optional = true }
sp-core = { workspace = true, features = ["full_crypto", "std"], optional = true }
sp-io = { workspace = true, features = ["std"], optional = true }
sp-externalities = { workspace = true, features = ["std"], optional = true }
scale-info = { workspace = true, optional = true }
tangle-subxt = { workspace = true, optional = true }

# Network-related
gadget-clients = { workspace = true, optional = true }
bollard = { workspace = true, optional = true }
url = { workspace = true, features = ["serde"], optional = true }

[features]
default = ["std", "tangle", "evm", "network"]

std = [
    "tokio",
    "tokio-stream",
    "tokio-util",
    "parking_lot",
    "sqlx",
    "nix",
    "sp-core/std",
    "sp-io/std",
    "sp-externalities/std",
    "scale-info/std"
]

network = [
    "gadget-clients",
    "bollard",
    "url",
    "http-body-util",
    "hyper",
    "hyper-util"
]

tangle = [
    "subxt",
    "subxt-core",
    "subxt-signer",
    "sp-core",
    "sp-io",
    "sp-externalities",
    "scale-info",
    "tangle-subxt"
]

evm = [
    "gadget-clients/evm",
    "alloy-contract",
    "alloy-network",
    "alloy-primitives",
    "alloy-json-abi",
    "alloy-provider",
    "alloy-rpc-types",
    "alloy-sol-types",
    "alloy-transport",
    "alloy-transport-http",
    "alloy-signer",
    "alloy-signer-local",
    "eigensdk"
]

keystore = [
    "ed25519-zebra",
    "k256",
    "schnorrkel",
    "w3f-bls"
]
